<div class="col-md-12 page-header">
  <div class="col-sm-10">
    <h2><i class="fa fa-user" style="font-size:50px;"></i><%= (+ "  " + @solicitante.nombres + " " + @solicitante.apellidos).upcase%></h2>
  </div>

</div>
<br>
  <div class="col-md-12">
    <ul class="nav nav-pills nav-justified">
      <li role="presentation"><%=link_to raw('<i class="fa fa-arrow-circle-left"></i> Regresar'), solicitantes_path%></li>
      <li role="presentation"><%=link_to raw('<i class="fa fa-pencil"></i> Editar'), edit_solicitante_path(@solicitante)%></li>
      <li style="padding-left:90px; color:#666" role="presentation" type="button" data-toggle="modal" data-target="#myModal"><i class="fa fa-plus"></i> Nuevo Beneficiario</li>
      <!--<%=link_to raw('<i class="fa fa-plus"></i> Nuevo Beneficiario'), new_solicitante_beneficiario_path(@solicitante)%> -->
    </ul>
  </div>

    <!-- Modal -->
    <div class="modal fade" id="myModal" style="margin-top:150px;" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
            <h4 class="modal-title" id="myModalLabel">
              <i class="fa fa-user fa-2x"></i>
              Nuevo Beneficiario</h4>
          </div>
          <div class="modal-body">
            <div class="col-xs-12 form-group" style="float:none">
            <div class="text-capitalize"><%= label_tag "¿Solicitante es el mismo beneficiario? " %>

            </br>
            <input type="radio" id="si" name="son_el_mismo" value="Si" class="son_el_mismo"/>
              <%= label_tag "Si" %>
            </br>
              <input type="radio" id="no" name="son_el_mismo" value="No" checked="checked" class="son_el_mismo"/>
              <%= label_tag "No" %>
            </br>
            </div>


            <div class="form-group input-group contenido">
              <!--Inicio del contenido del modal -->
              <div class="row">
                    <div class="col-md-12">
                      <ul class="list-group">
                        <li class="list-group-item text-muted" contenteditable="false">Búsqueda</li>
                        <li class="list-group-item ">

                          <div class="input-group">

                            <input type="text" class="form-control" placeholder="Buscar por cédula" name="search" id="search" value="<%= params[:search]%>">

                            <span class="input-group-addon">
                              <span id="search_icon" class="fa fa-search"></span>

                            </span>
                          </div>
                        </li>
                      </ul>
                      <ul class="list-group" style="width:500px">
                            <li class="list-group-item text-muted" contenteditable="false"><i class="fa fa-wpforms"></i> Resultado</li>
                            <li class="list-group-item ">
                              <div class="resultado2" id="resultado2">
                                <h2 class="text-center"><small>Realice una búsqueda...</small></h2>
                              </div>
                            </li>
                      </ul>
                      </div>
                </div>
              <!--Fin del contenido del modal -->
            </div>
          </div>
          </div>
              <div class="modal-footer">
                <div class="btn-group btn-group-md form-inline" role="group" aria-label="...">
                    <button type="button" class="btn btn-primary" id="generar_boton" name="button">Agregar</button>
                </div>
                <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
              </div>
        </div>
      </div>
  </div>
  <!-- Fin Modal -->

<p class="col-md-12">
  <br>
</p>
<div class="col-md-6">
  <ul class="list-group">
    <li class="list-group-item text-muted" contenteditable="false">
      <i class="fa fa-user"></i> Perfil</li>

    <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Cédula</strong>
      </span>
      <td><%= $dic["tipo_de_cedula"].key(@solicitante.tipo_cedula).to_s + "-" + @solicitante.cedula.to_s %></td>
    </li>


     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Estado Civil</strong>
      </span>
      <%= $dic["estado"].key(@solicitante.estado_civil).to_s %>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Sexo</strong>
      </span>
      <%= $dic["sexo"].key(@solicitante.sexo).to_s %>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Fecha de Nacimiento</strong>
      </span>
      <%= @solicitante.fecha_de_nacimiento.strftime("%d-%m-%Y")%>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Lugar de Nacimiento</strong>
      </span>
      <%= @solicitante.lugar_de_nacimiento.capitalize %>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Dirección</strong>
      </span>
      <%= @solicitante.direccion.capitalize %>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Municipio</strong>
      </span>
      <%= $dic["municipios"].key(@solicitante.municipios).to_s %>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Grado de Instrucción</strong>
      </span>
      <%= $dic["grado"].key(@solicitante.grado_de_instruccion).to_s %>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Observación</strong>
      </span>
      <%= @solicitante.obs_instruccion.capitalize %>
      <br>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Profesión/Oficio</strong>
      </span>
      <%= @solicitante.oficio %>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Ingreso Mensual</strong>
      </span>

      <%= number_to_currency(@solicitante.ingreso_mensual, unit: "", separator: ",", delimiter: ".", format: "%n %u") %>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Observación</strong>
      </span>
      <%= @solicitante.obs_ingreso.capitalize %>
      <br>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Empresa</strong>
      </span>
      <%= @solicitante.empresa.capitalize %>
    </br>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Carga Familiar</strong>
      </span>
      <%= @solicitante.carga_familiar.to_s %>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Teléfono Fijo</strong>
      </span>
      <%= @solicitante.telefono_fijo %>
      <br>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Teléfono Móvil</strong>
      </span>
      <%= @solicitante.telefono_movil %>
      <br>
     </li>

     <li class="list-group-item text-right">
      <span class="pull-left">
        <strong class="">Correo Electrónico</strong>
      </span>
      <%= @solicitante.correo %>
      <br>
     </li>
   </ul>
</div>
   <% if @solicitante.beneficiarios.length>0 %>
   <div class="col-md-6">
   <ul class="list-group">
     <li class="list-group-item text-muted" contenteditable="false"><i class="fa fa-users"></i> Beneficiario (os)</li>
     <li class="list-group-item">
       <table class="table table-hover table-condensed text-center">
         <thead>
           <tr>
             <th class="actions text-center" style="width:18%;">Cédula</th>
             <th class="actions text-center">Nombres</th>
             <th class="actions text-center" style="width:17%;">Fecha de Nacimiento</th>
             <th class="actions text-center" style="width:10%;">Sexo</th>
             <th class="actions text-center" style="width:10%;">Acciones</th>
           </tr>
         </thead>

         <tbody>
           <%@solicitante.beneficiarios.each do |beneficiario|%>
           <tr>
             <%if beneficiario.cedula == @solicitante.cedula%>
             <%else%>
             <td><%="#{$dic['tipo_de_cedula'].key(beneficiario.tipo_cedula)}-#{beneficiario.cedula}"%></td>
             <td class="text-capitalize"><%="#{beneficiario.nombres} #{beneficiario.apellidos}"%></td>
             <td><%=beneficiario.fecha_de_nacimiento.strftime("%d-%m-%Y")%></td>
             <td><%=$dic["sexo"].key(beneficiario.sexo.to_i)%></td>
             <td><%= link_to raw('<i class="fa fa-eye"></i>'), solicitante_beneficiario_path(@solicitante, beneficiario),class:"btn1 btn btn-success" %></td>
           </tr>
           <%end%>
           <%end%>
         </tbody>

       </table>
     </li>
   </ul>
   </div>
   <%else%>
   <div class="text-center col-md-6">
   <ul class="list-group">
     <li class="list-group-item text-muted text-left" contenteditable="false">
       <i class="fa fa-comment-o"></i>
       Mensaje</li>
     <li class="list-group-item"></br>
     <i class="fa fa-user-times fa-4x" style="color:#24A5FF;"></i>
     <h2>El solicitante no tiene beneficiarios.</h2>
   </li>
   </ul>
   </div>
   <%end%>

<!-- Solicitudes -->
<% if @solicitante.beneficiarios.length>0 %>
<div class="col-md-6">
<ul class="list-group">
  <li class="list-group-item text-muted" contenteditable="false"><i class="fa fa-users"></i>Mis Solicitudes</li>
  <li class="list-group-item">
    <table class="table table-hover table-condensed text-center">
      <thead>
      </thead>

      <tbody>
        <%@solicitante.beneficiarios.each do |beneficiario|%>
        <tr>
          <%if beneficiario.cedula != @solicitante.cedula%>

          <%else%>
            <td class="text-capitalize"><%="Ver Mis Solicitudes"%></td>
            <td><%= link_to raw('<i class="fa fa-eye"></i>'), solicitante_beneficiario_path(@solicitante, beneficiario),class:"btn1 btn btn-success" %></td>
        </tr>
        <%end%>
        <%end%>
      </tbody>

    </table>
  </li>
</ul>
</div>
<%else%>
<div class="text-center col-md-6">
<ul class="list-group">
  <li class="list-group-item text-muted text-left" contenteditable="false">
    <i class="fa fa-comment-o"></i>
    Mensaje</li>
  <li class="list-group-item"></br>
  <i class="fa fa-paper-plane fa-4x" style="color:#24A5FF;"></i>
  <h2>El solicitante no tiene solicitudes.</h2>
</li>
</ul>
</div>
<%end%>

</div>

<script type="text/javascript">
//Bloque del buscador
    var classes = ".resultado2";
    var delay = (function () {
      var timer = 0;
      return function (callback, ms) {
        clearTimeout(timer);
        timer = setTimeout(callback, ms);
      };
    })();
    function loading() {
      $("#search_icon").attr("class", "fa fa-refresh fa-spin fa-fw")
    }
    function query() {
      loading();
      return "/solicitantes?search=" + $("#search").val();
    }
    $(function () {

      $("#search").keyup(function () {
        delay(function () {
          $.getScript(query());
          return false;
        }, 500);
      });

    });
//Bloque del buscador



  $(function () {
    $('[data-toggle="tooltip"]').tooltip();
  });

  $('#generar_boton').click(function () {
    var si = document.getElementById("si");
    var no = document.getElementById("no");
    var t = "<%= @solicitante.tipo_cedula %>";
    var c = "<%= @solicitante.cedula %>";
    var n = "<%= @solicitante.nombres %>";
    var a = "<%= @solicitante.apellidos %>";
    var s = "<%= @solicitante.sexo %>";
    var f = "<%= @solicitante.fecha_de_nacimiento %>";

    if(si.checked){
     location.href ="http://localhost:3000/solicitantes/" + "<%= @solicitante.id %>" + "/beneficiarios/new?T="+t+"&C="+c+"&N="+n+"&A="+a+"&S="+s+"&F="+f+"";
    }else{
     location.href = "http://localhost:3000/solicitantes/" + "<%= @solicitante.id %>" + "/beneficiarios/new";
   };
  });

  //function s(x,y) {
  //$('#enviar').modal({
    //show: true, backdrop:false
  //});

  //Bloque de ocultar
  $(document).ready(function(){
        $(".son_el_mismo").click(function(evento){

            var valor = $(this).val();

            if(valor == 'Si'){
                $(".contenido").css("display", "none");
            }else{
                $(".contenido").css("display", "block");
            }
        });
  });
</script>
